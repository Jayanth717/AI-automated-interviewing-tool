<!DOCTYPE html>
<html>
<head>
  <style>
    .vega-actions a {
      margin-right: 12px;
      color: #757575;
      font-weight: normal;
      font-size: 13px;
    }
    .error { color: red; }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/vega@4"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@2.6.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@3"></script>
</head>

<body>
  <div id="vis"></div>

  <script>
    var spec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v2.6.0.json",
      "width": 600,
      "height": 300,
      "title": "Angry over Time (Hover to inspect)",
      "datasets": {
        "data-4edd90d1685d4abf64f4ded879d296af": [
          /* KEEP YOUR SAME DATA ARRAY HERE (UNCHANGED) */
        ]
      },

      "layer": [
        /* LINE */
        {
          "data": { "name": "data-4edd90d1685d4abf64f4ded879d296af" },
          "mark": { "type": "line", "color": "orange", "interpolate": "basis", "strokeWidth": 4 },
          "encoding": {
            "x": { "field": "Time", "type": "quantitative" },
            "y": { "field": "Angry", "type": "quantitative" },
            "tooltip": [{ "field": "Angry", "type": "quantitative" }]
          }
        },

        /* INVISIBLE POINTS JUST FOR SELECTION (MUST USE SAME DATA) */
        {
          "data": { "name": "data-4edd90d1685d4abf64f4ded879d296af" },
          "mark": "point",
          "encoding": {
            "opacity": { "value": 0 },
            "x": { "field": "Time", "type": "quantitative" }
          },
          "selection": {
            "selector007": {
              "type": "single",
              "nearest": true,
              "on": "mouseover",
              "fields": ["Time"],
              "empty": "none"
            }
          }
        },

        /* VISIBLE HOVER POINT */
        {
          "data": { "name": "data-4edd90d1685d4abf64f4ded879d296af" },
          "mark": "point",
          "encoding": {
            "opacity": { "condition": { "selection": "selector007", "value": 1 }, "value": 0 },
            "x": { "field": "Time", "type": "quantitative" },
            "y": { "field": "Angry", "type": "quantitative" },
            "tooltip": [{ "field": "Angry", "type": "quantitative" }]
          }
        },

        /* VERTICAL RULE */
        {
          "data": { "name": "data-4edd90d1685d4abf64f4ded879d296af" },
          "mark": { "type": "rule", "color": "gray" },
          "encoding": {
            "x": { "field": "Time", "type": "quantitative" }
          },
          "transform": [{ "filter": { "selection": "selector007" } }]
        },

        /* TEXT LABEL */
        {
          "data": { "name": "data-4edd90d1685d4abf64f4ded879d296af" },
          "mark": { "type": "text", "align": "left", "dx": 5, "dy": -5 },
          "encoding": {
            "x": { "field": "Time", "type": "quantitative" },
            "y": { "field": "Angry", "type": "quantitative" },
            "text": { "condition": { "selection": "selector007", "field": "Angry", "type": "quantitative" }, "value": "" }
          }
        }
      ]
    };

    function showError(el, error) {
      el.innerHTML =
        '<div class="error">' +
        '<p>JavaScript Error: ' + error.message + '</p>' +
        '<p>Open devtools console for full traceback.</p>' +
        '</div>';
      throw error;
    }

    const el = document.getElementById("vis");
    vegaEmbed("#vis", spec, { mode: "vega-lite" })
      .catch(err => showError(el, err));
  </script>
</body>
</html>
